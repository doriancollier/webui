---
title: Reverse Proxy
description: Configure nginx or Caddy as a reverse proxy for DorkOS
---

# Reverse Proxy

DorkOS uses Server-Sent Events (SSE) for real-time streaming. Reverse proxy configuration must account for SSE's long-lived connections and disable response buffering.

<Callout type="warn">
  Standard proxy settings will break SSE streaming. The configurations below include the required SSE-specific directives.
</Callout>

## Proxy Configuration

<Tabs items={["Caddy (Recommended)", "nginx"]}>

<Tab value="Caddy (Recommended)">
Caddy automatically handles HTTPS certificates and has good SSE support out of the box.

```
dorkos.example.com {
    reverse_proxy localhost:4242 {
        flush_interval -1
    }
}
```

The `flush_interval -1` setting disables response buffering, which is required for SSE streams to work correctly.
</Tab>

<Tab value="nginx">
```nginx
server {
    listen 443 ssl;
    server_name dorkos.example.com;

    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;

    location / {
        proxy_pass http://localhost:4242;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # SSE support: disable buffering and set long timeouts
        proxy_buffering off;
        proxy_cache off;
        proxy_read_timeout 86400s;
        proxy_send_timeout 86400s;

        # Required for SSE
        proxy_set_header Connection '';
        chunked_transfer_encoding off;
    }
}
```
</Tab>

</Tabs>

## Key SSE Settings (nginx)

These settings are critical for SSE to function correctly through nginx:

<TypeTable type={{
  "proxy_buffering off": { type: "directive", description: "Disables response buffering so SSE events are sent immediately" },
  "proxy_cache off": { type: "directive", description: "Disables caching since SSE streams should never be cached" },
  "proxy_read_timeout 86400s": { type: "directive", description: "24-hour timeout for long-lived SSE connections" },
  "Connection ''": { type: "header", description: "Empty connection header prevents premature connection close" },
  "chunked_transfer_encoding off": { type: "directive", description: "Disables chunked encoding since SSE uses its own framing" },
}} />

## Common Issues

<Steps>

<Step>
### SSE events arrive in batches instead of real-time

**Cause**: Response buffering is enabled in the reverse proxy.

**Fix**: Ensure `proxy_buffering off` (nginx) or `flush_interval -1` (Caddy).
</Step>

<Step>
### Connection drops after 60 seconds

**Cause**: Default proxy timeout is too short for SSE.

**Fix**: Increase `proxy_read_timeout` to at least `3600s` (1 hour).
</Step>

<Step>
### 502 Bad Gateway on long requests

**Cause**: The upstream timeout is shorter than the Claude response time.

**Fix**: Increase both `proxy_read_timeout` and `proxy_send_timeout`.
</Step>

</Steps>

## HTTPS with Let's Encrypt

<Tabs items={["Caddy (Automatic)", "nginx + certbot"]}>

<Tab value="Caddy (Automatic)">
Caddy handles Let's Encrypt automatically. Just point your domain's DNS to the server and Caddy obtains and renews certificates with no additional configuration.

```
dorkos.example.com {
    reverse_proxy localhost:4242 {
        flush_interval -1
    }
}
```
</Tab>

<Tab value="nginx + certbot">
Install certbot and request a certificate:

```bash
sudo certbot --nginx -d dorkos.example.com
```

Certbot modifies your nginx config to add SSL directives and sets up automatic renewal.
</Tab>

</Tabs>

## Next Steps

<Cards>
  <Card title="Deployment" href="/docs/self-hosting/deployment">
    Production deployment guide with systemd, environment variables, and health checks.
  </Card>
  <Card title="Tunnel Setup" href="/docs/guides/tunnel-setup">
    Alternative remote access via ngrok without a reverse proxy.
  </Card>
  <Card title="SSE Protocol" href="/docs/integrations/sse-protocol">
    Full SSE protocol reference for understanding the streaming wire format.
  </Card>
</Cards>
